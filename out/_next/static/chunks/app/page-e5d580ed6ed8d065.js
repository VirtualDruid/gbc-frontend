(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2708:function(e,t,n){Promise.resolve().then(n.bind(n,8212))},8212:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(7437),i=n(2265),a=n(4790),s=n(2599),o=n(4760),l=n.n(o),c=n(7630),d=n(8014),p=n(6648);let u=["1-3","4","5","6","7","8","9","10","11","12","13"],x="http://34.84.210.183:8080";function h(){let[e,t]=(0,i.useState)({episode:"",frame_current:-1,frame_start:-1,farme_end:-1}),[n,a]=(0,i.useState)(""),[o,l]=(0,i.useState)([]),[c,d]=(0,i.useState)("1-3"),p=(0,i.useCallback)(s.debounce((e,t)=>{0!==e.length?b(e,t).then(t=>{console.log(e),l(t.result)}):l([])},100),[]);(0,i.useEffect)(()=>{p(n,c)},[n,c]);let[x,h]=(0,i.useState)(""),[g,m]=(0,i.useState)(!1),[j,v]=(0,i.useState)(e.frame_current);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%",backgroundColor:"rgba(51, 129, 175, 0.7)"},children:[(0,r.jsx)(y,{resultList:o,setFullImageSrc:h,setIsVisible:m,setSegment:t,setCurrentFrame:v}),(0,r.jsxs)("div",{style:{position:"fixed",top:"0px"},children:[(0,r.jsx)("input",{style:{position:"relative",padding:"0.5rem",opacity:"0.7",top:"20px",left:"20px"},placeholder:"輸入台詞",value:n,onChange:e=>{a(e.currentTarget.value)}}),(0,r.jsx)("select",{style:{position:"relative",padding:"0.5rem",opacity:"0.7",top:"20px",left:"20px"},onChange:n=>{d(n.currentTarget.value),t({...e,episode:c})},children:u.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsx)(f,{fullImageSrc:x,setFullImageSrc:h,isVisible:g,setIsVisible:m,segment:e,setSegment:t,currentFrame:j,setCurrentFrame:v})]})})}function f(e){let{fullImageSrc:t,setFullImageSrc:n,isVisible:a,setIsVisible:o,segment:l,setSegment:d,currentFrame:u,setCurrentFrame:h}=e,f=(0,i.useCallback)(s.debounce((e,t)=>{n("".concat(x,"/image?frame=").concat(e,"&episode=").concat(t))},300),[]);return(0,r.jsx)("div",{style:{position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%",display:"flex",alignContent:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)",userSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",visibility:a?"visible":"hidden"},children:(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",position:"relative",width:"auto",height:"auto"},children:[(0,r.jsx)(p.default,{width:1280,height:720,alt:t,id:"full-image",src:t,loading:"lazy"}),(0,r.jsx)("div",{style:{position:"absolute",width:"auto",color:"red",padding:"20px"},children:"".concat(u-l.frame_start,"/").concat(l.frame_end-l.frame_start)}),(0,r.jsx)(c.Z,{onClick:function(e){n(""),o(!1),h(0)},style:{position:"absolute",width:"60px",height:"60px",color:"red",right:"20px"}}),(0,r.jsx)("input",{type:"range",onChange:function(e){f(e.currentTarget.value,l.episode),h(e.currentTarget.value)},style:{position:"absolute",width:"100%",height:"auto",bottom:"20px"},value:u,min:l.frame_start,max:l.frame_end})]})})}let g={List:(0,i.forwardRef)((e,t)=>{let{style:n,children:i,...a}=e;return(0,r.jsx)("div",{ref:t,...a,style:{display:"flex",flexWrap:"wrap",...n},children:i})}),Item:e=>{let{children:t}=e;return(0,r.jsx)("div",{style:{width:"20%",height:"20%",color:"white"},children:t})}},m=e=>{var t;let{index:n,result:i,setFullImageSrc:a,setIsVisible:s,setSegment:o,setCurrentFrame:c}=e;return(0,r.jsxs)("div",{style:{width:"100%",minHeight:"180px",height:"180px",display:"flex",flexWrap:"wrap"},children:[(0,r.jsxs)("div",{style:{position:"absolute",display:"flex"},children:[(0,r.jsx)("div",{style:{padding:"4px 4px 4px 8px",background:"rgba(0, 0, 0, 0.3)",fontWeight:"900",fontSize:"12px"},children:"".concat(n)}),(0,r.jsx)("div",{style:{padding:"4px 4px 4px 4px",background:"rgba(0, 0, 0, 0.3)",fontSize:"12px",color:"rgb(51, 129, 175)"},children:"".concat(i.episode)}),(0,r.jsx)("div",{style:{padding:"4px 12px 4px 4px",background:"rgba(0, 0, 0, 0.3)",fontSize:"12px",color:"red"},children:"".concat(i.frame_start," ~ ").concat(i.frame_end)}),(0,r.jsx)("div",{style:{padding:"4px 12px 4px 4px",background:"rgba(1.0, 0, 0, 0.3)",fontSize:"12px"},children:"".concat((t=i.frame_start,l().utc(t/23.98*1e3).format("HH:mm:ss.SSS")))})]}),(0,r.jsx)(d.Z,{title:(0,r.jsx)("h1",{style:{fontSize:"18px"},children:i.text}),arrow:!0,children:(0,r.jsx)(p.default,{width:320,height:180,alt:i.text,onClick:function(e){a("".concat(x,"/image?frame=").concat(i.frame_start,"&episode=").concat(i.episode)),o({episode:i.episode,frame_current:i.frame_start,frame_start:i.frame_start,frame_end:i.frame_end}),s(!0),c(i.frame_start)},loading:"lazy",crossOrigin:"anonymous",src:"".concat(x,"/thumb?frame=").concat(i.frame_start,"&episode=").concat(i.episode)})})]})};function y(e){let{resultList:t,setFullImageSrc:n,setIsVisible:i,setSegment:s,setCurrentFrame:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Mr,{useWindowScroll:!0,style:{height:"100%"},totalCount:t.length,data:t,components:g,itemContent:(e,t)=>(0,r.jsx)(m,{index:e,result:t,setFullImageSrc:n,setIsVisible:i,setSegment:s,setCurrentFrame:o})}),(0,r.jsx)("style",{children:"html, body, #root { margin: 0; padding: 0 }"})]})}async function b(e,t){return await fetch("".concat(x,"/api/search?keyword=").concat(e,"&episode=").concat(t)).then(e=>e.ok?e.json():Promise.resolve({result:[]}))}}},function(e){e.O(0,[866,386,411,971,23,744],function(){return e(e.s=2708)}),_N_E=e.O()}]);